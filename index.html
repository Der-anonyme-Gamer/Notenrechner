<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notenrechner - Deutsches Schulsystem</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #d32f2f;
            --primary-dark: #b71c1c;
            --secondary: #f57c00;
            --accent: #388e3c;
            --light: #f5f5f5;
            --dark: #212121;
            --gray: #757575;
            --light-gray: #e0e0e0;
            --success: #2e7d32;
            --warning: #f57c00;
            --error: #d32f2f;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --card-hover: 0 15px 40px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: white;
            padding: 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            min-width: 220px;
        }

        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .mode-btn.active {
            background: white;
            color: var(--primary);
            border-color: white;
            box-shadow: var(--card-shadow);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            align-items: start;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .calculator-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }

        .card h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h2 svg {
            width: 24px;
            height: 24px;
        }

        .clear-btn {
            background: #ffebee;
            color: var(--error);
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .clear-btn:hover {
            background: #ffcdd2;
            transform: translateY(-2px);
        }

        .grade-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 500px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .form-group label {
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .form-group input,
        .form-group select {
            padding: 1rem 1.25rem;
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
            background: #f9f9f9;
            font-weight: 500;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(211, 47, 47, 0.1);
            background: white;
        }

        .add-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 1.2rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin-top: 0.5rem;
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.3);
        }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(211, 47, 47, 0.4);
        }

        .add-btn:active {
            transform: translateY(0);
        }

        .grades-list {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem 1rem;
            text-align: center;
            color: var(--gray);
        }

        .empty-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            opacity: 0.7;
        }

        .empty-state p {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .empty-state span {
            font-size: 1rem;
            max-width: 300px;
        }

        .grade-item {
            display: flex;
            align-items: center;
            padding: 1.25rem;
            background: #f9f9f9;
            border-radius: 16px;
            transition: var(--transition);
            gap: 1rem;
            border: 1px solid #eee;
        }

        .grade-item:hover {
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }

        .grade-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 50px;
            height: 50px;
            border-radius: 12px;
            color: white;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .grade-badge.grade-1 { background: #2e7d32; }
        .grade-badge.grade-2 { background: #388e3c; }
        .grade-badge.grade-3 { background: #f57c00; }
        .grade-badge.grade-4 { background: #ff9800; }
        .grade-badge.grade-5 { background: #f44336; }
        .grade-badge.grade-6 { background: #d32f2f; }

        .grade-info {
            flex: 1;
        }

        .grade-name {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.25rem;
            font-size: 1.1rem;
        }

        .grade-details {
            font-size: 0.95rem;
            color: var(--gray);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .grade-details span {
            background: #f0f0f0;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .remove-btn {
            background: #ffebee;
            color: var(--error);
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .remove-btn:hover {
            background: #ffcdd2;
            transform: translateY(-2px);
        }

        .results-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.25rem;
        }

        .result-item {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }

        .result-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--card-hover);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
        }

        .result-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .result-header svg {
            width: 20px;
            height: 20px;
            color: var(--primary);
        }

        .result-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-label {
            font-weight: 600;
            color: var(--gray);
            font-size: 0.95rem;
        }

        .result-value {
            font-weight: 800;
            font-size: 1.8rem;
            color: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .result-subvalue {
            font-weight: 500;
            font-size: 1rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .grade-desc {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: center;
            margin-top: 0.5rem;
        }

        .grade-desc.sehr-gut { background: #2e7d32; }
        .grade-desc.gut { background: #388e3c; }
        .grade-desc.befriedigend { background: #f57c00; }
        .grade-desc.ausreichend { background: #ff9800; }
        .grade-desc.mangelhaft { background: #f44336; }
        .grade-desc.ungen√ºgend { background: #d32f2f; }

        .grade-scale {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .scale-item {
            background: white;
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }

        .scale-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--card-hover);
        }

        .scale-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: white;
            font-size: 1.3rem;
            margin: 0 auto 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .scale-number.grade-1 { background: #2e7d32; }
        .scale-number.grade-2 { background: #388e3c; }
        .scale-number.grade-3 { background: #f57c00; }
        .scale-number.grade-4 { background: #ff9800; }
        .scale-number.grade-5 { background: #f44336; }
        .scale-number.grade-6 { background: #d32f2f; }

        .scale-description {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .scale-range {
            font-weight: 500;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            padding: 1.25rem 1.75rem;
            border-radius: 16px;
            color: white;
            font-weight: 600;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: var(--card-hover);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--error);
        }

        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
            }
            
            .title {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .mode-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .mode-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .card {
                padding: 1.5rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .notification {
                top: 1rem;
                right: 1rem;
                left: 1rem;
                transform: translateY(-100px);
            }
            
            .notification.show {
                transform: translateY(0);
            }
        }

        /* Icons */
        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">Notenrechner</h1>
            <p class="subtitle">Berechne deine Endjahresnote nach deutschem Schulsystem</p>
        </header>

        <div class="mode-selector">
            <button id="modeWeiterf√ºhrend" class="mode-btn active">Unter-/ Mittelstufe</button>
            <button id="modeOberstufe" class="mode-btn">Oberstufe</button>
        </div>

        <main class="main-content">
            <div class="calculator-section">
                <div class="card">
                    <h2>
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z M12,17c-0.55,0-1-0.45-1-1s0.45-1,1-1 s1,0.45,1,1S12.55,17,12,17z M16,7H8C7.45,7,7,7.45,7,8v0.38C7,8.77,7.29,9.08,7.68,9.1c0.85,0.05,1.53,0.64,1.64,1.48 C9.38,11.26,10.07,12,11,12c0.93,0,1.62-0.74,1.68-1.42c0.11-0.84,0.79-1.43,1.64-1.48C14.71,9.08,15,8.77,15,8.38V8 C15,7.45,14.55,7,14,7z"/>
                        </svg>
                        Fach hinzuf√ºgen
                    </h2>
                    <form id="gradeForm" class="grade-form">
                        <div class="form-group">
                            <label for="subjectName">Fachname</label>
                            <input type="text" id="subjectName" placeholder="z.B. Mathematik" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gradeValue" id="gradeLabel">Note</label>
                                <select id="gradeValue" required>
                                    <option value="">Note w√§hlen</option>
                                    <option value="1">1 (sehr gut)</option>
                                    <option value="2">2 (gut)</option>
                                    <option value="3">3 (befriedigend)</option>
                                    <option value="4">4 (ausreichend)</option>
                                    <option value="5">5 (mangelhaft)</option>
                                    <option value="6">6 (ungen√ºgend)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="subjectType">Fachtyp</label>
                                <select id="subjectType" required>
                                    <option value="hauptfach" id="hauptfachOption">Hauptfach</option>
                                    <option value="nebenfach">Nebenfach</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="add-btn">
                            <span class="btn-text">Fach hinzuf√ºgen</span>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                            </svg>
                        </button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M5,5H19V19H5V5M7,7V17H17V7H7M9,9H15V15H9V9Z"/>
                            </svg>
                            Deine F√§cher
                        </h2>
                        <button id="clearAll" class="clear-btn" style="display: none;">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                            </svg>
                            Alle l√∂schen
                        </button>
                    </div>
                    
                    <div id="gradesList" class="grades-list">
                        <div class="empty-state">
                            <div class="empty-icon">üìö</div>
                            <p>Noch keine F√§cher hinzugef√ºgt</p>
                            <span>F√ºge dein erstes Fach hinzu, um zu beginnen</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="results-section">
                <div class="card">
                    <h2>
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                        </svg>
                        Aktuelle Ergebnisse
                    </h2>
                    
                    <div class="results-grid">
                        <div class="result-item">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7.07,18.28C7.5,17.38 10.12,16.5 12,16.5C13.88,16.5 16.5,17.38 16.93,18.28C15.57,19.36 13.86,20 12,20C10.14,20 8.43,19.36 7.07,18.28M18.36,16.83C16.93,15.09 13.46,14.5 12,14.5C10.54,14.5 7.07,15.09 5.64,16.83C4.62,15.5 4,13.82 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,13.82 19.38,15.5 18.36,16.83M12,6C10.06,6 8.5,7.56 8.5,9.5C8.5,11.44 10.06,13 12,13C13.94,13 15.5,11.44 15.5,9.5C15.5,7.56 13.94,6 12,6M12,11A1.5,1.5 0 0,1 10.5,9.5A1.5,1.5 0 0,1 12,8A1.5,1.5 0 0,1 13.5,9.5A1.5,1.5 0 0,1 12,11Z"/>
                                </svg>
                                <h3>Notendurchschnitt</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">Gesamtschnitt</div>
                                <div class="result-value">
                                    <span id="currentAverage">--</span>
                                    <div id="gradeDescription" class="grade-desc">--</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="result-item" id="abiturResult" style="display: none;">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M5,3C3.89,3 3,3.89 3,5V19C3,20.11 3.89,21 5,21H19C20.11,21 21,20.11 21,19V5C21,3.89 20.11,3 19,3H5M5,5H19V19H5V5M7,7V9H17V7H7M7,11V13H17V11H7M7,15V17H14V15H7Z"/>
                                </svg>
                                <h3>Abiturnote</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">Abschlussnote</div>
                                <div class="result-value" id="abiturGrade">--</div>
                            </div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"/>
                                </svg>
                                <h3 id="mainSubjectAverageLabel">Hauptf√§cher</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">Schnitt</div>
                                <div class="result-value">
                                    <span id="mainSubjectAverage">--</span>
                                    <div id="mainSubjectGrade" class="result-subvalue"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                                </svg>
                                <h3 id="minorSubjectAverageLabel">Nebenf√§cher</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">Schnitt</div>
                                <div class="result-value">
                                    <span id="minorSubjectAverage">--</span>
                                    <div id="minorSubjectGrade" class="result-subvalue"></div>
                                </div>
                            </div>
                        </div>

                        <div class="result-item" id="bestMainSubjects" style="display: none;">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M12,2L15.09,8.26L22,9.27L17,14.14L18.18,21.02L12,17.77L5.82,21.02L7,14.14L2,9.27L8.91,8.26L12,2Z"/>
                                </svg>
                                <h3>Beste Leistungskurse</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">F√§cher</div>
                                <div class="result-value" id="bestLks">--</div>
                            </div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-header">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                </svg>
                                <h3>Fachanzahl</h3>
                            </div>
                            <div class="result-content">
                                <div class="result-label">Gesamt</div>
                                <div class="result-value" id="subjectCount">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                        </svg>
                        Notenskala
                    </h2>
                    <div class="grade-scale">
                        <div class="scale-item">
                            <div class="scale-number grade-1">1</div>
                            <div class="scale-description">sehr gut</div>
                            <div class="scale-range">1,0 - 1,5</div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number grade-2">2</div>
                            <div class="scale-description">gut</div>
                            <div class="scale-range">1,6 - 2,5</div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number grade-3">3</div>
                            <div class="scale-description">befriedigend</div>
                            <div class="scale-range">2,6 - 3,5</div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number grade-4">4</div>
                            <div class="scale-description">ausreichend</div>
                            <div class="scale-range">3,6 - 4,5</div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number grade-5">5</div>
                            <div class="scale-description">mangelhaft</div>
                            <div class="scale-range">4,6 - 5,5</div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number grade-6">6</div>
                            <div class="scale-description">ungen√ºgend</div>
                            <div class="scale-range">5,6 - 6,0</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div id="notification" class="notification"></div>
    </div>

    <script>
        class GermanGradeCalculator {
            constructor() {
                this.grades = [];
                this.currentMode = 'weiterf√ºhrend';
                document.getElementById('subjectType').value = 'nebenfach';
                this.initializeEventListeners();
                this.updateModeDisplay();
                this.loadFromLocalStorage();
            }

            initializeEventListeners() {
                const form = document.getElementById('gradeForm');
                const clearAllBtn = document.getElementById('clearAll');
                const modeWeiterf√ºhrendBtn = document.getElementById('modeWeiterf√ºhrend');
                const modeOberstufeBtn = document.getElementById('modeOberstufe');

                form.addEventListener('submit', (e) => this.handleAddGrade(e));
                clearAllBtn.addEventListener('click', () => this.clearAllGrades());
                
                modeWeiterf√ºhrendBtn.addEventListener('click', () => this.switchMode('weiterf√ºhrend'));
                modeOberstufeBtn.addEventListener('click', () => this.switchMode('oberstufe'));
            }

            switchMode(mode) {
                this.clearAllGrades(true);
                this.currentMode = mode;
                this.updateModeDisplay();
                this.updateResults();
                this.loadFromLocalStorage();
            }

            updateModeDisplay() {
                const modeWeiterf√ºhrendBtn = document.getElementById('modeWeiterf√ºhrend');
                const modeOberstufeBtn = document.getElementById('modeOberstufe');
                const abiturResult = document.getElementById('abiturResult');
                const bestMainSubjects = document.getElementById('bestMainSubjects');
                const mainSubjectAverageLabel = document.getElementById('mainSubjectAverageLabel');
                const minorSubjectAverageLabel = document.getElementById('minorSubjectAverageLabel');
                const gradeLabel = document.getElementById('gradeLabel');
                const gradeValue = document.getElementById('gradeValue');
                const hauptfachOption = document.getElementById('hauptfachOption');

                if (this.currentMode === 'weiterf√ºhrend') {
                    modeWeiterf√ºhrendBtn.classList.add('active');
                    modeOberstufeBtn.classList.remove('active');
                    abiturResult.style.display = 'none';
                    bestMainSubjects.style.display = 'none';
                    mainSubjectAverageLabel.textContent = 'Hauptf√§cher';
                    minorSubjectAverageLabel.textContent = 'Nebenf√§cher';
                    gradeLabel.textContent = 'Note';
                    hauptfachOption.textContent = 'Hauptfach';
                } else {
                    modeWeiterf√ºhrendBtn.classList.remove('active');
                    modeOberstufeBtn.classList.add('active');
                    abiturResult.style.display = 'flex';
                    bestMainSubjects.style.display = 'flex';
                    mainSubjectAverageLabel.textContent = 'Leistungskurse';
                    minorSubjectAverageLabel.textContent = 'Grundkurse';
                    gradeLabel.textContent = 'Punkte';
                    hauptfachOption.textContent = 'Leistungskurs (LK)';
                }

                if (this.currentMode === 'oberstufe') {
                    gradeValue.innerHTML = `
                        <option value="">Punkte w√§hlen</option>
                        <option value="15">15 Punkte (1+)</option>
                        <option value="14">14 Punkte (1)</option>
                        <option value="13">13 Punkte (1-)</option>
                        <option value="12">12 Punkte (2+)</option>
                        <option value="11">11 Punkte (2)</option>
                        <option value="10">10 Punkte (2-)</option>
                        <option value="9">9 Punkte (3+)</option>
                        <option value="8">8 Punkte (3)</option>
                        <option value="7">7 Punkte (3-)</option>
                        <option value="6">6 Punkte (4+)</option>
                        <option value="5">5 Punkte (4)</option>
                        <option value="4">4 Punkte (4-)</option>
                        <option value="3">3 Punkte (5+)</option>
                        <option value="2">2 Punkte (5)</option>
                        <option value="1">1 Punkt (5-)</option>
                        <option value="0">0 Punkte (6)</option>
                    `;
                } else {
                    gradeValue.innerHTML = `
                        <option value="">Note w√§hlen</option>
                        <option value="1">1 (sehr gut)</option>
                        <option value="2">2 (gut)</option>
                        <option value="3">3 (befriedigend)</option>
                        <option value="4">4 (ausreichend)</option>
                        <option value="5">5 (mangelhaft)</option>
                        <option value="6">6 (ungen√ºgend)</option>
                    `;
                }
            }

            handleAddGrade(e) {
                e.preventDefault();
                
                const name = document.getElementById('subjectName').value.trim();
                const gradeValue = parseFloat(document.getElementById('gradeValue').value);
                const subjectType = document.getElementById('subjectType').value;
                let weight = 1;
                
                if (this.currentMode === 'weiterf√ºhrend') {
                    weight = subjectType === 'hauptfach' ? 2 : 1;
                } else {
                    weight = subjectType === 'hauptfach' ? 2 : 1;
                }

                // Validation
                if (!name) {
                    this.showNotification('Bitte gib einen Fachnamen ein', 'error');
                    return;
                }

                if (isNaN(gradeValue)) {
                    this.showNotification('Bitte w√§hle eine Note/Punkte aus', 'error');
                    return;
                }

                if (this.currentMode === 'weiterf√ºhrend') {
                    if (gradeValue < 1 || gradeValue > 6) {
                        this.showNotification('Note muss zwischen 1 und 6 liegen', 'error');
                        return;
                    }
                } else {
                    if (gradeValue < 0 || gradeValue > 15) {
                        this.showNotification('Punkte m√ºssen zwischen 0 und 15 liegen', 'error');
                        return;
                    }
                }

                // Add grade
                const grade = {
                    id: Date.now(),
                    name,
                    value: gradeValue,
                    weight,
                    subjectType,
                    mode: this.currentMode
                };

                this.grades.push(grade);
                this.saveToLocalStorage();
                this.updateDisplay();
                this.clearForm();
                this.showNotification('Fach erfolgreich hinzugef√ºgt!', 'success');
            }

            removeGrade(id) {
                this.grades = this.grades.filter(grade => grade.id !== id);
                this.updateDisplay();
                this.showNotification('Fach entfernt', 'success');
                this.saveToLocalStorage();
            }

            clearAllGrades(silent = false) {
                if (this.grades.length === 0) return;
                
                this.grades = [];
                this.updateDisplay();
                if (!silent) {
                    this.saveToLocalStorage();
                    this.showNotification('Alle F√§cher gel√∂scht', 'success');
                }
            }

            saveToLocalStorage(mode = this.currentMode) {
                localStorage.setItem(mode, JSON.stringify(this.grades));
            }

            loadFromLocalStorage(mode = this.currentMode) {
                const data = localStorage.getItem(mode);
                if (data) {
                    this.grades = JSON.parse(data);
                    this.updateDisplay();
                    if( this.grades.length > 0) {
                        this.showNotification('F√§cher erfolgreich geladen', 'success');
                        this.updateDisplay();
                    }
                }
            }

            calculateSubjectAverages() {
    if (this.grades.length === 0) {
        return {
            average: 0,
            mainAverage: 0,
            minorAverage: 0,
            mainGrade: 0,
            minorGrade: 0,
            bestLks: []
        };
    }

    if (this.currentMode === 'weiterf√ºhrend') {
        const mainGrades = this.grades.filter(g => g.subjectType === 'hauptfach');
        const minorGrades = this.grades.filter(g => g.subjectType === 'nebenfach');
        
        // Calculate averages
        const mainAverage = mainGrades.length ? 
            mainGrades.reduce((sum, grade) => sum + grade.value, 0) / mainGrades.length : 0;
        const minorAverage = minorGrades.length ? 
            minorGrades.reduce((sum, grade) => sum + grade.value, 0) / minorGrades.length : 0;
        
        // Overall average
        const totalWeighted = this.grades.reduce((sum, grade) => 
            sum + (grade.value * grade.weight), 0);
        const totalWeight = this.grades.reduce((sum, grade) => sum + grade.weight, 0);
        const average = totalWeight ? totalWeighted / totalWeight : 0;

        return {
            average,
            mainAverage,
            minorAverage,
            mainGrade: mainAverage,
            minorGrade: minorAverage,
            bestLks: []
        };
    } else {
        const lks = this.grades.filter(grade => grade.subjectType === 'hauptfach');
        const gks = this.grades.filter(grade => grade.subjectType === 'nebenfach');
        
        // Group LKs by subject
        const lkPunkte = {};
        lks.forEach(lk => {
            if (!lkPunkte[lk.name]) {
                lkPunkte[lk.name] = 0;
            }
            lkPunkte[lk.name] += lk.value;
        });
        
        // Get best 2 LKs (sorted by points)
        const bestTwoLks = Object.entries(lkPunkte)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 2);
        
        // Calculate LK average (only from best 2 LKs)
        const bestLkSum = bestTwoLks.reduce((sum, [_, punkte]) => sum + punkte, 0);
        // Add the other Lk 
        const otherLks = Object.entries(lkPunkte).filter(([name]) => !bestTwoLks.some(([bestName]) => bestName === name));
        const mainAverage = bestTwoLks.length ? 
            (bestLkSum *2 + otherLks.reduce((sum, [_, punkte]) => sum + punkte, 0)) / (bestTwoLks.length *2 + otherLks.length) : 0;
        
        // Calculate GK average
        const gkSum = gks.reduce((sum, gk) => sum + gk.value, 0);
        const minorAverage = gks.length ? gkSum / gks.length : 0;
        
        // Overall average calculation (including double counting of best LKs)
        const einfachLks = Object.values(lkPunkte).reduce((sum, punkte) => sum + punkte, 0);
        const extraDoppelt = bestTwoLks.reduce((sum, [_, punkte]) => sum + punkte, 0);
        const gesamtSumme = einfachLks + extraDoppelt + gkSum;
        const gesamtGewichtung = gks.length + Object.keys(lkPunkte).length + 2;
        const average = gesamtGewichtung ? gesamtSumme / gesamtGewichtung : 0;
        
        // Convert to grades
        const mainGrade = this.convertPointsToGrade(mainAverage);
        const minorGrade = this.convertPointsToGrade(minorAverage);
        
        return {
            average,
            mainAverage,
            minorAverage,
            mainGrade,
            minorGrade,
            bestLks: bestTwoLks.map(([name]) => name)
        };
    }
}

            getGradeDescription(average, isPoints = false) {
                if (isPoints) {
                    if (average >= 13) return { text: 'sehr gut', class: 'sehr-gut' };
                    if (average >= 10) return { text: 'gut', class: 'gut' };
                    if (average >= 7) return { text: 'befriedigend', class: 'befriedigend' };
                    if (average >= 4) return { text: 'ausreichend', class: 'ausreichend' };
                    if (average >= 1) return { text: 'mangelhaft', class: 'mangelhaft' };
                    if (average >= 0) return { text: 'ungen√ºgend', class: 'ungen√ºgend' };
                } else {
                    if (average >= 1 && average <= 1.5) return { text: 'sehr gut', class: 'sehr-gut' };
                    if (average > 1.5 && average <= 2.5) return { text: 'gut', class: 'gut' };
                    if (average > 2.5 && average <= 3.5) return { text: 'befriedigend', class: 'befriedigend' };
                    if (average > 3.5 && average <= 4.5) return { text: 'ausreichend', class: 'ausreichend' };
                    if (average > 4.5 && average <= 5.5) return { text: 'mangelhaft', class: 'mangelhaft' };
                    if (average > 5.5 && average <= 6) return { text: 'ungen√ºgend', class: 'ungen√ºgend' };
                }
                return { text: '--', class: '' };
            }

            convertPointsToGrade(points) {
                if(points <= 0) return 6;
                const grade = (17 - points) / 3;
                return Math.max(1.0, Math.min(6.0, Math.round(grade * 10) / 10));
            }

            calculateAbiturNote(averagePoints) {
                const abiturNote = 6 - (averagePoints / 3);
                return Math.max(1.0, Math.min(4.0, Math.round(abiturNote * 10) / 10));
            }

            updateDisplay() {
                this.updateGradesList();
                this.updateResults();
                this.updateClearButton();
            }

            updateGradesList() {
                const gradesList = document.getElementById('gradesList');
                
                if (this.grades.length === 0) {
                    gradesList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">üìö</div>
                            <p>Noch keine F√§cher hinzugef√ºgt</p>
                            <span>F√ºge dein erstes Fach hinzu, um zu beginnen</span>
                        </div>
                    `;
                    return;
                }

                gradesList.innerHTML = this.grades.map(grade => {
                    const displayValue = this.currentMode === 'oberstufe' ? 
                        `${grade.value} Punkte` : 
                        `Note ${grade.value}`;
                    
                    let subjectTypeText;
                    if (this.currentMode === 'weiterf√ºhrend') {
                        subjectTypeText = grade.subjectType === 'hauptfach' ? 'Hauptfach (2x)' : 'Nebenfach (1x)';
                    } else {
                        subjectTypeText = grade.subjectType === 'hauptfach' ? 'Leistungskurs (2x)' : 'Grundkurs (1x)';
                    }
                    
                    const badgeValue = this.currentMode === 'oberstufe' ? 
                        this.convertPointsToGrade(grade.value) : grade.value;
                    
                    return `
                        <div class="grade-item">
                            <div class="grade-badge grade-${Math.ceil(badgeValue)}">
                                ${grade.value}
                            </div>
                            <div class="grade-info">
                                <div class="grade-name">${grade.name}</div>
                                <div class="grade-details">
                                    <span>${displayValue}</span>
                                    <span>${subjectTypeText}</span>
                                </div>
                            </div>
                            <button class="remove-btn" onclick="calculator.removeGrade(${grade.id})">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                                </svg>
                                Entfernen
                            </button>
                        </div>
                    `;
                }).join('');
            }

            updateResults() {
                const {
                    average,
                    mainAverage,
                    minorAverage,
                    mainGrade,
                    minorGrade,
                    bestLks
                } = this.calculateSubjectAverages();
                
                const gradeDesc = this.getGradeDescription(
                    this.currentMode === 'oberstufe' ? average : average, 
                    this.currentMode === 'oberstufe'
                );

                // Update current average
                if (this.grades.length > 0) {
                    if (this.currentMode === 'weiterf√ºhrend') {
                        document.getElementById('currentAverage').textContent = average.toFixed(2);
                    } else {
                        document.getElementById('currentAverage').textContent = average.toFixed(1);
                    }
                } else {
                    document.getElementById('currentAverage').textContent = '--';
                }

                // Update grade description
                const gradeDescElement = document.getElementById('gradeDescription');
                gradeDescElement.textContent = gradeDesc.text;
                gradeDescElement.className = `grade-desc ${gradeDesc.class}`;

                // Update main subject average
                const mainSubjectAverage = document.getElementById('mainSubjectAverage');
                const mainSubjectGrade = document.getElementById('mainSubjectGrade');
                if (this.grades.length > 0) {
                    if (this.currentMode === 'weiterf√ºhrend') {
                        mainSubjectAverage.textContent = mainAverage.toFixed(2);
                        mainSubjectGrade.textContent = '';
                    } else {
                        mainSubjectAverage.textContent = mainAverage.toFixed(1);
                        mainSubjectGrade.textContent = `(${mainGrade.toFixed(1)})`;
                    }
                } else {
                    mainSubjectAverage.textContent = '--';
                    mainSubjectGrade.textContent = '';
                }

                // Update minor subject average
                const minorSubjectAverage = document.getElementById('minorSubjectAverage');
                const minorSubjectGrade = document.getElementById('minorSubjectGrade');
                if (this.grades.length > 0) {
                    if (this.currentMode === 'weiterf√ºhrend') {
                        minorSubjectAverage.textContent = minorAverage.toFixed(2);
                        minorSubjectGrade.textContent = '';
                    } else {
                        minorSubjectAverage.textContent = minorAverage.toFixed(1);
                        minorSubjectGrade.textContent = `(${minorGrade.toFixed(1)})`;
                    }
                } else {
                    minorSubjectAverage.textContent = '--';
                    minorSubjectGrade.textContent = '';
                }

                // Update Abitur note (only for Oberstufe)
                if (this.currentMode === 'oberstufe' && this.grades.length > 0) {
                    const abiturNote = this.calculateAbiturNote(average);
                    document.getElementById('abiturGrade').textContent = abiturNote.toFixed(1);
                    document.getElementById('bestLks').textContent = bestLks.join(', ') || '--';
                } else {
                    document.getElementById('abiturGrade').textContent = '--';
                }

                // Update subject count
                document.getElementById('subjectCount').textContent = 
                    this.grades.length > 0 ? this.grades.length : '--';
            }

            updateClearButton() {
                const clearBtn = document.getElementById('clearAll');
                clearBtn.style.display = this.grades.length > 0 ? 'flex' : 'none';
            }

            clearForm() {
                document.getElementById('subjectName').value = '';
                document.getElementById('gradeValue').value = '';
                document.getElementById('subjectType').value = 'nebenfach';
                document.getElementById('subjectName').focus();
            }

            showNotification(message, type) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                
                // Show notification
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);
                
                // Hide notification after 3 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3100);
            }
        }

        // Initialize the calculator when the page loads
        const calculator = new GermanGradeCalculator();

        // Focus on the first input field when page loads
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('subjectName').focus();
        });
    </script>
</body>
</html>
